jQuery(function(d){"use strict";function e(e){var t,n=jQuery.Deferred();return(t=jQuery.Deferred(),o.addClass(i),setTimeout(function(){o.removeClass(i).hide(),t.resolve()},200),t.promise()).done(function(){var t,i;i=n,t="all"!==(t=e)&&t?'[data-categories*="'+t+'"]':"div",o.filter(t).show().addClass("ocdi-is-fadein"),setTimeout(function(){o.removeClass("ocdi-is-fadein"),i.resolve()},200)}),n}var o,i;function a(t,i,e){return e.indexOf(t)===i}function s(t,i,e,n,o){var a=t[i].name;d.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_install_plugin",security:ocdi.ajax_nonce,slug:a},beforeSend:function(){var t=d(".plugin-item-"+a);t.find(".js-ocdi-plugin-item-info").empty(),t.find(".js-ocdi-plugin-item-error").empty(),t.addClass("plugin-item--loading")}}).done(function(t){var i=d(".plugin-item-"+a);i.removeClass("plugin-item--loading"),t.success?(i.addClass("plugin-item--active"),i.find("input[type=checkbox]").prop("disabled",!0)):(-1===t.data.indexOf("<p>")&&(t.data="<p>"+t.data+"</p>"),i.find(".js-ocdi-plugin-item-error").append(t.data),i.find("input[type=checkbox]").prop("checked",!1),o=!0)}).fail(function(t){var i=d(".plugin-item-"+a);i.removeClass("plugin-item--loading"),i.find(".js-ocdi-plugin-item-error").append("<p>"+t.statusText+" ("+t.status+")</p>"),o=!0}).always(function(){++i===t.length?(n&&(o?alert(ocdi.texts.plugin_install_failed):l(c("import"))),e.removeClass("ocdi-button-disabled")):s(t,i,e,n,o)})}function c(t){for(var i,e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++)if((i=e[n].split("="))[0]===t)return i[1],decodeURIComponent(i[1]);return!1}function l(t){var i=new FormData;i.append("action","ocdi_import_demo_data"),i.append("security",ocdi.ajax_nonce),t&&i.append("selected",t),function e(n){d.ajax({method:"POST",url:ocdi.ajax_url,data:n,contentType:!1,processData:!1,beforeSend:function(){d(".js-ocdi-install-plugins-content").hide(),d(".js-ocdi-importing").show()}}).done(function(t){var i;void 0!==t.status&&"newAJAX"===t.status?e(n):void 0!==t.status&&"customizerAJAX"===t.status?((i=new FormData).append("action","ocdi_import_customizer_data"),i.append("security",ocdi.ajax_nonce),!0===ocdi.wp_customize_on&&i.append("wp_customize","on"),e(i)):void 0!==t.status&&"afterAllImportAJAX"===t.status?((i=new FormData).append("action","ocdi_after_import_data"),i.append("security",ocdi.ajax_nonce),e(i)):void 0!==t.message?(d(".js-ocdi-ajax-response").append(t.message),void 0!==t.title&&d(".js-ocdi-ajax-response-title").html(t.title),void 0!==t.subtitle&&d(".js-ocdi-ajax-response-subtitle").html(t.subtitle),d(".js-ocdi-importing").hide(),d(".js-ocdi-imported").show(),d(document).trigger("ocdiImportComplete")):(d(".js-ocdi-ajax-response").append('<img class="ocdi-imported-content-imported ocdi-imported-content-imported--error" src="'+ocdi.plugin_url+'assets/images/error.svg" alt="'+ocdi.texts.import_failed+'"><p>'+t+"</p>"),d(".js-ocdi-ajax-response-title").html(ocdi.texts.import_failed),d(".js-ocdi-ajax-response-subtitle").html("<p>"+ocdi.texts.import_failed_subtitle+"</p>"),d(".js-ocdi-importing").hide(),d(".js-ocdi-imported").show())}).fail(function(t){d(".js-ocdi-ajax-response").append('<img class="ocdi-imported-content-imported ocdi-imported-content-imported--error" src="'+ocdi.plugin_url+'assets/images/error.svg" alt="'+ocdi.texts.import_failed+'"><p>Error: '+t.statusText+" ("+t.status+")</p>"),d(".js-ocdi-ajax-response-title").html(ocdi.texts.import_failed),d(".js-ocdi-ajax-response-subtitle").html("<p>"+ocdi.texts.import_failed_subtitle+"</p>"),d(".js-ocdi-importing").hide(),d(".js-ocdi-imported").show()})}(i)}d(".js-ocdi-notice-wrapper").appendTo(".js-ocdi-admin-notices-container"),d(".js-ocdi-auto-start-manual-import").length&&l(!1),d(".js-ocdi-start-manual-import").on("click",function(t){t.preventDefault();var i=d(this);if(i.hasClass("ocdi-button-disabled"))return!1;i.addClass("ocdi-button-disabled");t=new FormData;t.append("action","ocdi_upload_manual_import_files"),t.append("security",ocdi.ajax_nonce),d("#ocdi__content-file-upload").length&&d("#ocdi__content-file-upload").get(0).files.length&&t.append("content_file",d("#ocdi__content-file-upload")[0].files[0]),d("#ocdi__widget-file-upload").length&&d("#ocdi__widget-file-upload").get(0).files.length&&t.append("widget_file",d("#ocdi__widget-file-upload")[0].files[0]),d("#ocdi__customizer-file-upload").length&&d("#ocdi__customizer-file-upload").get(0).files.length&&t.append("customizer_file",d("#ocdi__customizer-file-upload")[0].files[0]),d("#ocdi__redux-file-upload").length&&d("#ocdi__redux-file-upload").get(0).files.length&&(t.append("redux_file",d("#ocdi__redux-file-upload")[0].files[0]),t.append("redux_option_name",d("#ocdi__redux-option-name").val())),d.ajax({method:"POST",url:ocdi.ajax_url,data:t,contentType:!1,processData:!1}).done(function(t){t.success?window.location.href=ocdi.import_url:(alert(t.data),i.removeClass("ocdi-button-disabled"))}).fail(function(t){alert(t.statusText+" ("+t.status+")"),i.removeClass("ocdi-button-disabled")})}),d(".js-ocdi-cancel-manual-import").on("click",function(){d(".ocdi__file-upload-container-items input[type=file]").each(function(){d(this).val("").trigger("change")})}),d(document).on("change",".ocdi__file-upload-container-items input[type=file]",function(){var t=d(this),i=t.siblings("label"),e=!1;this.files&&0<this.files.length?(t.removeClass("ocdi-hide-input").blur(),i.hide()):(t.addClass("ocdi-hide-input"),i.show()),d(".ocdi__file-upload-container-items input[type=file]").each(function(){this.files&&0<this.files.length&&(e=!0)}),d(".js-ocdi-start-manual-import").prop("disabled",!e),d(".js-ocdi-cancel-manual-import").prop("disabled",!e)}),d(".ocdi-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(t){return t.preventDefault(),!1}),d(".js-ocdi-install-plugins").on("click",function(t){t.preventDefault();var i=d(this);if(i.hasClass("ocdi-button-disabled"))return!1;t=d(".ocdi-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray();if(0===t.length)return!1;i.addClass("ocdi-button-disabled"),s(t,0,i,!1,!1)}),d(".js-ocdi-install-plugins-before-import").on("click",function(t){t.preventDefault();var i=d(this);if(i.hasClass("ocdi-button-disabled"))return!1;t=d(".ocdi-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray();if(0===t.length)return l(c("import")),!1;i.addClass("ocdi-button-disabled"),s(t,0,i,!0,!1)}),d(".js-ocdi-create-content").on("click",function(t){t.preventDefault();var i=d(this);if(i.hasClass("ocdi-button-disabled"))return!1;t=d(".ocdi-create-content-content .content-item input[type=checkbox]").serializeArray();if(0===t.length)return!1;i.addClass("ocdi-button-disabled"),function e(n,o,a){var t=n[o],s=t.name;d.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_import_created_content",security:ocdi.ajax_nonce,slug:s},beforeSend:function(){var t=d(".content-item-"+s);t.find(".js-ocdi-content-item-info").empty(),t.find(".js-ocdi-content-item-error").empty(),t.addClass("content-item--loading")}}).done(function(t){var i;t.data&&t.data.refresh?e(n,o,a):((i=d(".content-item-"+s)).removeClass("content-item--loading"),t.success?i.find(".js-ocdi-content-item-info").append("<p>"+ocdi.texts.successful_import+"</p>"):i.find(".js-ocdi-content-item-error").append("<p>"+t.data+"</p>"))}).fail(function(t){var i=d(".content-item-"+s);i.removeClass("content-item--loading"),i.find(".js-ocdi-content-item-error").append("<p>"+t.statusText+" ("+t.status+")</p>")}).always(function(t){t.data&&t.data.refresh||(++o===n.length?a.removeClass("ocdi-button-disabled"):e(n,o,a))})}(t,0,i)}),d(".js-ocdi-install-coming-soon-plugin").on("click",function(t){t.preventDefault();var i=d(this);if(i.hasClass("ocdi-button-disabled"))return!1;i.addClass("ocdi-button-disabled"),d.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_install_plugin",security:ocdi.ajax_nonce,slug:"coming-soon"},beforeSend:function(){i.text(ocdi.texts.installing)}}).done(function(t){t.success?i.text(ocdi.texts.installed):(alert(t.data),i.text(ocdi.texts.install_plugin),i.removeClass("ocdi-button-disabled"))}).fail(function(t){alert(t.statusText+" ("+t.status+")"),i.removeClass("ocdi-button-disabled")})}),d(document).on("change",".ocdi--create-content .content-item input[type=checkbox]",function(t){var i=d(".ocdi--create-content .content-item input[type=checkbox]"),e=d(".js-ocdi-create-content-install-plugins-notice"),n=[];i.each(function(){var i,e,t=d(this);t.is(":checked")&&(n=n.concat((i=(i=t.data("plugins")).split(","),e=[],ocdi.missing_plugins.forEach(function(t){-1!==i.indexOf(t.slug)&&e.push(t.name)}),e)))}),0<(n=n.filter(a).join(", ")).length?(e.find(".js-ocdi-create-content-install-plugins-list").text(n),e.show()):(e.find(".js-ocdi-create-content-install-plugins-list").text(""),e.hide())}),o=d(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item"),i="ocdi-is-fadeout",d(".js-ocdi-nav-link").on("click",function(t){t.preventDefault(),d(this).parent().siblings().removeClass("active"),d(this).parent().addClass("active");var t=this.hash.slice(1),i=d(".js-ocdi-gl-item-container");i.css("min-width",i.outerHeight()),e(t).done(function(){i.removeAttr("style")})}),d(".js-ocdi-gl-search").on("keyup",function(t){0<d(this).val().length?(d(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item").hide(),d(".js-ocdi-gl-item-container").find('.js-ocdi-gl-item[data-name*="'+d(this).val().toLowerCase()+'"]').show()):d(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item").show()})});