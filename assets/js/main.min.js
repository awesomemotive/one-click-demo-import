jQuery(function(r){"use strict";function e(e){var i,o=jQuery.Deferred();return(i=jQuery.Deferred(),n.addClass(t),setTimeout(function(){n.removeClass(t).hide(),i.resolve()},200),i.promise()).done(function(){var i,t;t=o,i="all"!==(i=e)&&i?'[data-categories*="'+i+'"]':"div",n.filter(i).show().addClass("ocdi-is-fadein"),setTimeout(function(){n.removeClass("ocdi-is-fadein"),t.resolve()},200)}),o}var n,t;function p(i){window.location.href=ocdi.import_page_url+"&import="+i}function o(e){r.ajax({method:"POST",url:ocdi.ajax_url,data:e,contentType:!1,processData:!1,beforeSend:function(){r(".js-ocdi-install-plugins-content").hide(),r(".js-ocdi-importing").show()}}).done(function(i){var t;void 0!==i.status&&"newAJAX"===i.status?o(e):void 0!==i.status&&"customizerAJAX"===i.status?((t=new FormData).append("action","ocdi_import_customizer_data"),t.append("security",ocdi.ajax_nonce),!0===ocdi.wp_customize_on&&t.append("wp_customize","on"),o(t)):void 0!==i.status&&"afterAllImportAJAX"===i.status?((t=new FormData).append("action","ocdi_after_import_data"),t.append("security",ocdi.ajax_nonce),o(t)):void 0!==i.message?(r(".js-ocdi-ajax-response").append(i.message),void 0!==i.title&&r(".js-ocdi-ajax-response-title").html(i.title),void 0!==i.subtitle&&r(".js-ocdi-ajax-response-subtitle").html(i.subtitle),r(".js-ocdi-importing").hide(),r(".js-ocdi-imported").show(),r(document).trigger("ocdiImportComplete")):(r(".js-ocdi-ajax-response").append('<img class="ocdi-imported-content-imported ocdi-imported-content-imported--error" src="'+ocdi.plugin_url+'assets/images/error.svg" alt="'+ocdi.texts.error_icon+'"><p>'+i+"</p>"),r(".js-ocdi-ajax-response-title").html(ocdi.texts.import_failed),r(".js-ocdi-ajax-response-subtitle").html(ocdi.texts.import_failed_subtitle),r(".js-ocdi-importing").hide(),r(".js-ocdi-imported").show())}).fail(function(i){r(".js-ocdi-ajax-response").append('<img class="ocdi-imported-content-imported ocdi-imported-content-imported--error" src="'+ocdi.plugin_url+'assets/images/error.svg" alt="'+ocdi.texts.error_icon+'"><p>Error: '+i.statusText+" ("+i.status+")</p>"),r(".js-ocdi-ajax-response-title").html(ocdi.texts.import_failed),r(".js-ocdi-ajax-response-subtitle").html(ocdi.texts.import_failed_subtitle),r(".js-ocdi-importing").hide(),r(".js-ocdi-imported").show()})}function s(i,t,e){return e.indexOf(i)===t}function d(i,t,e,o){var n=i[t].name;r.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_install_plugin",security:ocdi.ajax_nonce,slug:n},beforeSend:function(){var i=r(".plugin-item-"+n);i.find(".js-ocdi-plugin-item-info").empty(),i.find(".js-ocdi-plugin-item-error").empty(),i.find(".js-ocdi-plugin-item-info").append("<p>"+ocdi.texts.installing+"</p>")}}).done(function(i){var t=r(".plugin-item-"+n);t.find(".js-ocdi-plugin-item-info").empty(),i.success?(t.addClass("plugin-item--active"),t.find("input[type=checkbox]").prop("disabled",!0)):t.find(".js-ocdi-plugin-item-error").append("<p>"+i.data+"</p>")}).fail(function(i){var t=r(".plugin-item-"+n);t.find(".js-ocdi-plugin-item-info").empty(),t.find(".js-ocdi-plugin-item-error").append("<p>"+i.statusText+" ("+i.status+")</p>")}).always(function(){++t===i.length?(e.removeClass("ocdi-button-disabled"),o&&c(a("import"))):d(i,t,e,o)})}function a(i){for(var t,e=window.location.search.substring(1).split("&"),o=0;o<e.length;o++)if((t=e[o].split("="))[0]===i)return t[1],decodeURIComponent(t[1]);return!1}function c(i){var t=new FormData;t.append("action","ocdi_import_demo_data"),t.append("security",ocdi.ajax_nonce),t.append("selected",i),o(t)}r(".js-ocdi-import-data").on("click",function(){r(".js-ocdi-ajax-response").empty();var i=new FormData;i.append("action","ocdi_import_demo_data"),i.append("security",ocdi.ajax_nonce),i.append("selected",r("#ocdi__demo-import-files").val()),r("#ocdi__content-file-upload").length&&i.append("content_file",r("#ocdi__content-file-upload")[0].files[0]),r("#ocdi__widget-file-upload").length&&i.append("widget_file",r("#ocdi__widget-file-upload")[0].files[0]),r("#ocdi__customizer-file-upload").length&&i.append("customizer_file",r("#ocdi__customizer-file-upload")[0].files[0]),r("#ocdi__redux-file-upload").length&&(i.append("redux_file",r("#ocdi__redux-file-upload")[0].files[0]),i.append("redux_option_name",r("#ocdi__redux-option-name").val())),o(i)}),r(".js-ocdi-gl-import-data").on("click",function(){var i,t,e,o,n,s,d,a,c=r(this).val(),l=r(this).closest(".js-ocdi-gl-item");ocdi.import_popup?(i=c,t=l,e=r("#js-ocdi-modal-content"),o=ocdi.import_files[i].import_preview_image_url||ocdi.theme_screenshot,n="",s=ocdi.import_files[i].import_notice||"",d="",a=r.extend({dialogClass:"wp-dialog",resizable:!1,height:"auto",modal:!0},ocdi.dialog_options,{buttons:[{text:ocdi.texts.dialog_no,click:function(){r(this).dialog("close")}},{text:ocdi.texts.dialog_yes,class:"button  button-primary",click:function(){r(this).dialog("close"),p(i)}}]}),n=""===o?"<p>"+ocdi.texts.missing_preview_image+"</p>":'<div class="ocdi__modal-image-container"><img src="'+o+'" alt="'+ocdi.import_files[i].import_file_name+'"></div>',""!==s&&(d='<div class="ocdi__modal-notice  ocdi__demo-import-notice">'+s+"</div>"),e.prop("title",ocdi.texts.dialog_title),e.html('<p class="ocdi__modal-item-title">'+ocdi.import_files[i].import_file_name+"</p>"+n+d),e.dialog(a)):p(c)}),r(document).on("ready",function(){r(".js-ocdi-notice-wrapper").appendTo(".js-ocdi-admin-notices-container")}),r(".ocdi-install-plugins-content-content .plugin-item.plugin-item--required input[type=checkbox]").on("click",function(i){return i.preventDefault(),!1}),r(".js-ocdi-install-plugins").on("click",function(i){i.preventDefault();var t=r(this);if(t.hasClass("ocdi-button-disabled"))return!1;i=r(".ocdi-install-plugins-content-content .plugin-item input[type=checkbox]").serializeArray();if(0===i.length)return!1;t.addClass("ocdi-button-disabled"),d(i,0,t,!1)}),r(".js-ocdi-install-plugins-before-import").on("click",function(i){i.preventDefault();var t=r(this);if(t.hasClass("ocdi-button-disabled"))return!1;i=r(".ocdi-install-plugins-content-content .plugin-item:not(.plugin-item--disabled) input[type=checkbox]").serializeArray();if(0===i.length)return c(a("import")),!1;t.addClass("ocdi-button-disabled"),d(i,0,t,!0)}),r(".js-ocdi-create-content").on("click",function(i){i.preventDefault();var t=r(this);if(t.hasClass("ocdi-button-disabled"))return!1;i=r(".ocdi-create-content-content .content-item input[type=checkbox]").serializeArray();if(0===i.length)return!1;t.addClass("ocdi-button-disabled"),function o(n,s,d){var i=n[s],a=i.name;r.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_import_created_content",security:ocdi.ajax_nonce,slug:a},beforeSend:function(){var i=r(".content-item-"+a);i.find(".js-ocdi-content-item-info").empty(),i.find(".js-ocdi-content-item-error").empty(),i.find(".js-ocdi-content-item-info").append("<p>"+ocdi.texts.importing+"</p>")}}).done(function(i){i.data&&i.data.refresh&&o(n,s,d);var t=r(".content-item-"+a),e=t.find(".js-ocdi-content-item-info");e.empty(),i.success?e.append("<p>"+ocdi.texts.successful_import+"</p>"):t.find(".js-ocdi-content-item-error").append("<p>"+i.data+"</p>")}).fail(function(i){var t=r(".content-item-"+a);t.find(".js-ocdi-content-item-info").empty(),t.find(".js-ocdi-content-item-error").append("<p>"+i.statusText+" ("+i.status+")</p>")}).always(function(i){i.data&&i.data.refresh||(++s===n.length?d.removeClass("ocdi-button-disabled"):o(n,s,d))})}(i,0,t)}),r(".js-ocdi-install-coming-soon-plugin").on("click",function(i){i.preventDefault();var t=r(this);if(t.hasClass("ocdi-button-disabled"))return!1;t.addClass("ocdi-button-disabled"),r.ajax({method:"POST",url:ocdi.ajax_url,data:{action:"ocdi_install_plugin",security:ocdi.ajax_nonce,slug:"coming-soon"},beforeSend:function(){t.text(ocdi.texts.installing)}}).done(function(i){i.success?(alert(ocdi.texts.successfully_installed),t.text(ocdi.texts.installed)):(alert(i.data),t.removeClass("ocdi-button-disabled"))}).fail(function(i){alert(i.statusText+" ("+i.status+")"),t.removeClass("ocdi-button-disabled")})}),r(document).on("change",".ocdi--create-content .content-item input[type=checkbox]",function(i){var t=r(".ocdi--create-content .content-item input[type=checkbox]"),e=r(".js-ocdi-create-content-install-plugins-notice"),o=[];t.each(function(){var t,e,i=r(this);i.is(":checked")&&(o=o.concat((t=(t=i.data("plugins")).split(","),e=[],ocdi.missing_plugins.forEach(function(i){-1!==t.indexOf(i.slug)&&e.push(i.name)}),e)))}),0<(o=o.filter(s).join(", ")).length?(e.find(".js-ocdi-create-content-install-plugins-list").text(o),e.show()):(e.find(".js-ocdi-create-content-install-plugins-list").text(""),e.hide())}),n=r(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item"),t="ocdi-is-fadeout",r(".js-ocdi-nav-link").on("click",function(i){i.preventDefault(),r(this).parent().siblings().removeClass("active"),r(this).parent().addClass("active");var i=this.hash.slice(1),t=r(".js-ocdi-gl-item-container");t.css("min-width",t.outerHeight()),e(i).done(function(){t.removeAttr("style")})}),r(".js-ocdi-gl-search").on("keyup",function(i){0<r(this).val().length?(r(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item").hide(),r(".js-ocdi-gl-item-container").find('.js-ocdi-gl-item[data-name*="'+r(this).val().toLowerCase()+'"]').show()):r(".js-ocdi-gl-item-container").find(".js-ocdi-gl-item").show()})});